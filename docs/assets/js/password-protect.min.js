!function(){"use strict";var e=window.protectedPageConfig||{},t=e.storageKey||"aquarius_arch_auth",r=e.passwordHash||"",o=e.redirectUrl||"/",n=e.maxAttempts||3,i=e.lockoutDuration||3e5,s=t+"_lockout",a=t+"_attempts";function d(){var e=parseInt(sessionStorage.getItem(a)||"0",10);return Math.max(0,n-e)}function c(){var e=document.createElement("div");e.id="password-protect-overlay",e.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:10000;display:flex;align-items:center;justify-content:center;";var c=document.createElement("div");c.style.cssText="background:#fff;padding:2rem;border-radius:8px;max-width:400px;width:90%;text-align:center;box-shadow:0 4px 20px rgba(0,0,0,0.3);";var u=d();c.innerHTML='<h2 style="margin:0 0 1rem;color:#333;font-size:1.5rem;">üîí Gesch√ºtzter Bereich</h2><p style="margin:0 0 1.5rem;color:#666;">Dieser Bereich ist nur f√ºr autorisierte Trainingsteilnehmer zug√§nglich.</p><form id="password-form"><input type="password" id="password-input" placeholder="Passwort eingeben" style="width:100%;padding:0.75rem;font-size:1rem;border:2px solid #ddd;border-radius:4px;box-sizing:border-box;margin-bottom:1rem;" autocomplete="current-password" /><div id="password-error" style="color:#dc3545;margin-bottom:1rem;display:none;"></div><button type="submit" style="width:100%;padding:0.75rem;font-size:1rem;background:#007bff;color:#fff;border:none;border-radius:4px;cursor:pointer;">Zugang anfordern</button></form><p style="margin:1rem 0 0;font-size:0.85rem;color:#999;">Verbleibende Versuche: <span id="attempts-count">'+u+'</span></p><a href="'+o+'" style="display:inline-block;margin-top:1rem;color:#666;text-decoration:none;font-size:0.9rem;">‚Üê Zur√ºck zur Startseite</a>',e.appendChild(c),document.body.appendChild(e);var l=document.getElementById("password-input");l.focus();var p=document.getElementById("password-form");p.addEventListener("submit",async function(o){o.preventDefault();var c,u=l.value,m=document.getElementById("password-error"),g=document.getElementById("attempts-count");if(!u)return m.textContent="Bitte Passwort eingeben",void(m.style.display="block");try{if(await async function(e){var t=(new TextEncoder).encode(e),r=await crypto.subtle.digest("SHA-256",t);return Array.from(new Uint8Array(r)).map(function(e){return e.toString(16).padStart(2,"0")}).join("")}(u)===r)sessionStorage.setItem(t,"authenticated"),sessionStorage.removeItem(a),sessionStorage.removeItem(s),e.remove(),document.body.style.overflow="";else if(c=parseInt(sessionStorage.getItem(a)||"0",10)+1,sessionStorage.setItem(a,c.toString()),c>=n&&(sessionStorage.setItem(s,(Date.now()+i).toString()),!0))m.textContent="Zu viele Fehlversuche. Bitte warten Sie 5 Minuten.",m.style.display="block",l.disabled=!0,p.querySelector("button").disabled=!0;else{var f=d();g.textContent=f,m.textContent="Falsches Passwort. Noch "+f+" Versuch(e).",m.style.display="block",l.value="",l.focus()}}catch(e){m.textContent="Ein Fehler ist aufgetreten. Bitte versuchen Sie es erneut.",m.style.display="block",console.error("Password check error:",e)}}),document.body.style.overflow="hidden"}function u(){var e;"authenticated"!==sessionStorage.getItem(t)&&((e=parseInt(sessionStorage.getItem(s)||"0",10))>Date.now()||(e>0&&(sessionStorage.removeItem(s),sessionStorage.removeItem(a)),0)?function(){var e=document.createElement("div");e.style.cssText="position:fixed;top:0;left:0;width:100%;height:100%;background:rgba(0,0,0,0.85);z-index:10000;display:flex;align-items:center;justify-content:center;";var t=document.createElement("div");t.style.cssText="background:#fff;padding:2rem;border-radius:8px;max-width:400px;width:90%;text-align:center;";var r=parseInt(sessionStorage.getItem(s)||"0",10),n=Math.max(0,r-Date.now()),i=Math.ceil(n/6e4);t.innerHTML='<h2 style="margin:0 0 1rem;color:#dc3545;">‚è≥ Zugang gesperrt</h2><p style="color:#666;">Zu viele fehlgeschlagene Anmeldeversuche.</p><p style="color:#666;">Bitte warten Sie noch <strong>'+i+' Minute(n)</strong>.</p><a href="'+o+'" style="display:inline-block;margin-top:1rem;padding:0.75rem 1.5rem;background:#6c757d;color:#fff;text-decoration:none;border-radius:4px;">Zur√ºck zur Startseite</a>',e.appendChild(t),document.body.appendChild(e),document.body.style.overflow="hidden"}():c())}"loading"===document.readyState?document.addEventListener("DOMContentLoaded",u):u()}();